{
    "zabbix_export": {
        "version": "6.0",
        "date": "2024-07-22T15:19:07Z",
        "groups": [
            {
                "uuid": "6f2e7ba69072492aa3c81b2fa6e78a87",
                "name": "Templates/Check Health/Zabbix Environment"
            }
        ],
        "templates": [
            {
                "uuid": "16040a13d3c2418b81ed17680dbd3fe9",
                "template": "Zabbix Security Advisories and CVE database",
                "name": "Zabbix Security Advisories and CVE database",
                "description": "This template monitors active security advisories and CVEs in the Zabbix environment.\n\nIt captures the latest security advisories and CVE information to generate the same view in Zabbix, ensuring continuous monitoring and integration.\n\nDate: 2024-07-18\n\nFor more details, visit my GitHub: higorcamposs/zabbix-security-advisories-cve-database",
                "groups": [
                    {
                        "name": "Templates/Check Health/Zabbix Environment"
                    }
                ],
                "items": [
                    {
                        "uuid": "79b458f56b5a4bfe9919ae2e25bed133",
                        "name": "Get JSON with Zabbix Security Advisories and CVE database",
                        "type": "EXTERNAL",
                        "key": "getCve.py[{$ZBXVERSION}]",
                        "delay": "1d",
                        "history": "0",
                        "trends": "0",
                        "value_type": "TEXT"
                    }
                ],
                "discovery_rules": [
                    {
                        "uuid": "1cc2c82732584ab39a9f7c0ed97f6d21",
                        "name": "DIscovery CVE in JSON",
                        "type": "DEPENDENT",
                        "key": "discoveryCve",
                        "delay": "0",
                        "lifetime": "0",
                        "item_prototypes": [
                            {
                                "uuid": "fe02fb3061eb43a69bd727e2340c4ca6",
                                "name": "{#CVENUMBER}",
                                "type": "CALCULATED",
                                "key": "key[{#ZABBIXID}]",
                                "delay": "1d",
                                "history": "1d",
                                "trends": "0",
                                "value_type": "TEXT",
                                "params": "{#ZABBIXSEVERITY}",
                                "trigger_prototypes": [
                                    {
                                        "uuid": "019934b999e141da94d681617cd75937",
                                        "expression": "last(/Zabbix Security Advisories and CVE database/key[{#ZABBIXID}])<>\"Green\"",
                                        "name": "[{#CVENUMBER} - Score: {#CVSSSCORE}] {#SYNOPSIS} ({#ZABBIXSEVERITY})",
                                        "url": "https://www.zabbix.com/br/security_advisories",
                                        "description": "{#AFFECTEDVERSIONS}\n{#PUBLISHED}",
                                        "manual_close": "YES",
                                        "tags": [
                                            {
                                                "tag": "zabbix",
                                                "value": "security-advisories"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "getCve.py[{$ZBXVERSION}]"
                        },
                        "overrides": [
                            {
                                "name": "Define Severity",
                                "step": "1",
                                "filter": {
                                    "conditions": [
                                        {
                                            "macro": "{#ZABBIXSEVERITY}",
                                            "operator": "EXISTS",
                                            "formulaid": "A"
                                        }
                                    ]
                                },
                                "operations": [
                                    {
                                        "operationobject": "TRIGGER_PROTOTYPE",
                                        "operator": "LIKE",
                                        "value": "Critical",
                                        "status": "ENABLED",
                                        "discover": "DISCOVER",
                                        "severity": "DISASTER"
                                    },
                                    {
                                        "operationobject": "TRIGGER_PROTOTYPE",
                                        "operator": "LIKE",
                                        "value": "High",
                                        "status": "ENABLED",
                                        "discover": "DISCOVER",
                                        "severity": "HIGH"
                                    },
                                    {
                                        "operationobject": "TRIGGER_PROTOTYPE",
                                        "operator": "LIKE",
                                        "value": "Low",
                                        "status": "ENABLED",
                                        "discover": "DISCOVER",
                                        "severity": "WARNING"
                                    },
                                    {
                                        "operationobject": "TRIGGER_PROTOTYPE",
                                        "operator": "LIKE",
                                        "value": "Medium",
                                        "status": "ENABLED",
                                        "discover": "DISCOVER",
                                        "severity": "AVERAGE"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "macros": [
                    {
                        "macro": "{$ZBXVERSION}",
                        "description": "If your version is LTS, enter: 6.0 lts (example). If it is not LTS, enter: 5.4 (example)"
                    }
                ]
            }
        ]
    }
}